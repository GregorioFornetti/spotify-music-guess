(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))t(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&t(c)}).observe(document,{childList:!0,subtree:!0});function n(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function t(o){if(o.ep)return;o.ep=!0;const i=n(o);fetch(o.href,i)}})();const l="https://gregoriofornetti.github.io/spotify-music-guess/dist";async function g(e){const r=y(128),n=await h(r);localStorage.setItem("verifier",r);const t=new URLSearchParams;t.append("client_id",e),t.append("response_type","code"),t.append("redirect_uri",l),t.append("scope","user-read-private user-read-email user-modify-playback-state"),t.append("code_challenge_method","S256"),t.append("code_challenge",n),document.location=`https://accounts.spotify.com/authorize?${t.toString()}`}async function m(e,r){const n=localStorage.getItem("verifier"),t=new URLSearchParams;t.append("client_id",e),t.append("grant_type","authorization_code"),t.append("code",r),t.append("redirect_uri",l),t.append("code_verifier",n);const o=await fetch("https://accounts.spotify.com/api/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:t}),{access_token:i}=await o.json();return i}function y(e){let r="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(let t=0;t<e;t++)r+=n.charAt(Math.floor(Math.random()*n.length));return r}async function h(e){const r=new TextEncoder().encode(e),n=await window.crypto.subtle.digest("SHA-256",r);return btoa(String.fromCharCode.apply(null,[...new Uint8Array(n)])).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}const s="([A-Za-z0-9]{22})",_=new RegExp(`^${s}$`),u=new RegExp(`^spotify:playlist:${s}$`),f=new RegExp(`^https://open.spotify.com/playlist/${s}(\\?si=.*)?$`);function w(e){return u.test(e)}function v(e){return f.test(e)}function b(e){return _.test(e)}function S(e){return e.match(u)[1]}function x(e){return e.match(f)[1]}function E(e){if(w(e))return S(e);if(v(e))return x(e);if(b(e))return e;throw new Error("URI, URL ou ID invÃ¡lido.")}async function L(e,r){return fetch(`https://api.spotify.com/v1/playlists/${e}`,{method:"GET",headers:{Authorization:`Bearer ${r}`}}).then(t=>t.json())}const a="b3c2339a149d46afa94a39347466b623",$=new URLSearchParams(window.location.search),d=$.get("code");var p;if(!d)g(a);else{const e=await m(a,d);(p=document.getElementById("playlist-form"))==null||p.addEventListener("submit",async r=>{r.preventDefault();const n=document.getElementById("playlist-input").value;try{const t=E(n),o=await L(t,e);console.log(o)}catch(t){console.log(t)}})}
