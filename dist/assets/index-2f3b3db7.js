(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))t(o);new MutationObserver(o=>{for(const c of o)if(c.type==="childList")for(const i of c.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&t(i)}).observe(document,{childList:!0,subtree:!0});function r(o){const c={};return o.integrity&&(c.integrity=o.integrity),o.referrerPolicy&&(c.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?c.credentials="include":o.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function t(o){if(o.ep)return;o.ep=!0;const c=r(o);fetch(o.href,c)}})();async function f(e){const n=m(128),r=await g(n);localStorage.setItem("verifier",n);const t=new URLSearchParams;t.append("client_id",e),t.append("response_type","code"),t.append("redirect_uri","http://localhost:5173/callback"),t.append("scope","user-read-private user-read-email user-modify-playback-state"),t.append("code_challenge_method","S256"),t.append("code_challenge",r),document.location=`https://accounts.spotify.com/authorize?${t.toString()}`}async function h(e,n){const r=localStorage.getItem("verifier"),t=new URLSearchParams;t.append("client_id",e),t.append("grant_type","authorization_code"),t.append("code",n),t.append("redirect_uri","http://localhost:5173/callback"),t.append("code_verifier",r);const o=await fetch("https://accounts.spotify.com/api/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:t}),{access_token:c}=await o.json();return c}function m(e){let n="",r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(let t=0;t<e;t++)n+=r.charAt(Math.floor(Math.random()*r.length));return n}async function g(e){const n=new TextEncoder().encode(e),r=await window.crypto.subtle.digest("SHA-256",n);return btoa(String.fromCharCode.apply(null,[...new Uint8Array(r)])).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}const a="([A-Za-z0-9]{22})",y=new RegExp(`^${a}$`),p=new RegExp(`^spotify:playlist:${a}$`),u=new RegExp(`^https://open.spotify.com/playlist/${a}(\\?si=.*)?$`);function _(e){return p.test(e)}function w(e){return u.test(e)}function b(e){return y.test(e)}function v(e){return e.match(p)[1]}function S(e){return e.match(u)[1]}function x(e){if(_(e))return v(e);if(w(e))return S(e);if(b(e))return e;throw new Error("URI, URL ou ID invÃ¡lido.")}async function E(e,n){return fetch(`https://api.spotify.com/v1/playlists/${e}`,{method:"GET",headers:{Authorization:`Bearer ${n}`}}).then(t=>t.json())}const s="b3c2339a149d46afa94a39347466b623",L=new URLSearchParams(window.location.search),l=L.get("code");var d;if(!l)f(s);else{const e=await h(s,l);(d=document.getElementById("playlist-form"))==null||d.addEventListener("submit",async n=>{n.preventDefault();const r=document.getElementById("playlist-input").value;try{const t=x(r),o=await E(t,e);console.log(o)}catch(t){console.log(t)}})}
